"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const transport_1 = require("./transport");
const WebSocket = require("ws");
class WebsocketTransport extends transport_1.Transport {
    connect() {
        this.socket = new WebSocket(this.options.url, this.options.additionalOptions);
        this.socket.on('open', () => this.callbacks.connect());
        this.socket.on('message', (data) => this.callbacks.data(data));
        this.socket.on('close', () => this.callbacks.disconnect());
        this.socket.on('error', (e) => this.callbacks.error(e));
    }
    send(data) {
        this.socket.send(data);
    }
    disconnect() {
        if (![this.socket.CLOSED, this.socket.CLOSING].includes(this.socket.readyState))
            this.socket.close();
    }
}
exports.WebsocketTransport = WebsocketTransport;
//# sourceMappingURL=websocket.transport.js.map